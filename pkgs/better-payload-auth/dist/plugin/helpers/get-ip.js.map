{"version":3,"sources":["../../../src/plugin/helpers/get-ip.ts"],"sourcesContent":["import type { BetterAuthOptions } from 'better-auth'\n\nexport function getIp(headers: Headers, options: BetterAuthOptions): string | null {\n  if (options.advanced?.ipAddress?.disableIpTracking) {\n    return null\n  }\n  const testIP = '127.0.0.1'\n  if ((process.env.NODE_ENV === 'test' || process.env.NODE_ENV === 'development') ?? false) {\n    return testIP\n  }\n  const ipHeaders = options.advanced?.ipAddress?.ipAddressHeaders\n  const keys = ipHeaders || [\n    'x-client-ip',\n    'x-forwarded-for',\n    'cf-connecting-ip',\n    'fastly-client-ip',\n    'x-real-ip',\n    'x-cluster-client-ip',\n    'x-forwarded',\n    'forwarded-for',\n    'forwarded',\n  ]\n  for (const key of keys) {\n    const value = headers.get(key)\n    if (typeof value === 'string') {\n      const ip = value.split(',')[0].trim()\n      if (ip) return ip\n    }\n  }\n  return null\n}\n"],"names":["getIp","headers","options","advanced","ipAddress","disableIpTracking","testIP","process","env","NODE_ENV","ipHeaders","ipAddressHeaders","keys","key","value","get","ip","split","trim"],"mappings":"AAEA,OAAO,SAASA,MAAMC,OAAgB,EAAEC,OAA0B;IAChE,IAAIA,QAAQC,QAAQ,EAAEC,WAAWC,mBAAmB;QAClD,OAAO;IACT;IACA,MAAMC,SAAS;IACf,IAAI,AAACC,CAAAA,QAAQC,GAAG,CAACC,QAAQ,KAAK,UAAUF,QAAQC,GAAG,CAACC,QAAQ,KAAK,aAAY,KAAM,OAAO;QACxF,OAAOH;IACT;IACA,MAAMI,YAAYR,QAAQC,QAAQ,EAAEC,WAAWO;IAC/C,MAAMC,OAAOF,aAAa;QACxB;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACD,KAAK,MAAMG,OAAOD,KAAM;QACtB,MAAME,QAAQb,QAAQc,GAAG,CAACF;QAC1B,IAAI,OAAOC,UAAU,UAAU;YAC7B,MAAME,KAAKF,MAAMG,KAAK,CAAC,IAAI,CAAC,EAAE,CAACC,IAAI;YACnC,IAAIF,IAAI,OAAOA;QACjB;IACF;IACA,OAAO;AACT"}